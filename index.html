<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brave Pink Hero Green</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Menyembunyikan input file standar */
        #imageUpload {
            display: none;
        }
        /* Styling tambahan untuk slider */
        #contrastSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #1b602f;
            cursor: pointer;
            border-radius: 50%;
        }
        #contrastSlider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #1b602f;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>
<body class="bg-[#1b602f] flex items-center justify-center min-h-screen p-4 relative">
    <div id="main-content" class="bg-[#f784c5] p-8 md:p-12 rounded-xl shadow-2xl w-full max-w-2xl text-center transition-opacity duration-500">
        <h1 class="text-4xl font-bold text-white mb-2">Brave Pink Hero Green</h1>
        <p class="text-white mb-6">Pink simbol keberanian warga, hijau simbol perjuangan & harapan.</p>
        
        <!-- Area Input Gambar -->
        <div class="flex flex-col items-center justify-center p-6 border-2 border-dashed border-[#1a502a] rounded-lg">
            <label for="imageUpload" class="cursor-pointer bg-[#1b602f] hover:bg-[#1a502a] text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-300 shadow-md">
                Pilih Foto
            </label>
            <input type="file" id="imageUpload" accept="image/*">
            <p class="mt-4 text-sm text-[#1a502a]">Pilih file gambar (JPG, PNG, dll.)</p>
        </div>

        <!-- Sakelar Pembalikan Warna -->
        <div class="mt-6 flex items-center justify-center">
            <label for="reverseColors" class="flex items-center cursor-pointer">
                <!-- Checkbox yang disembunyikan -->
                <input type="checkbox" id="reverseColors" class="sr-only peer">
                <!-- Toggle Switch -->
                <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-white rounded-full peer-checked:bg-[#1b602f] after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full"></div>
                <span class="ml-3 text-[#1a502a]">Balik Warna Sorotan & Bayangan</span>
            </label>
        </div>
        
        <!-- Kontrol Kontras Gambar -->
        <div class="mt-6">
            <label for="contrastSlider" class="block text-[#1a502a] font-semibold mb-2">
                Kontras: <span id="contrastValue">0</span>
            </label>
            <input type="range" id="contrastSlider" min="-100" max="100" value="0" class="w-full h-2 rounded-lg bg-[#1a502a] appearance-none cursor-pointer">
        </div>

        <!-- Area Tampilan Gambar -->
        <div id="imageArea" class="mt-8 relative hidden">
            <canvas id="canvas" class="w-full h-auto rounded-lg shadow-xl"></canvas>
            
            <!-- Tautan Unduh -->
            <a id="downloadLink" class="inline-block mt-6 bg-[#1b602f] hover:bg-[#1a502a] text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-300 shadow-md" download="duotone-image.png">
                Unduh Gambar
            </a>
        </div>
    </div>

    <!-- Instagram Logo and Text at the bottom-left -->
    <div class="fixed bottom-4 left-4 flex items-center space-x-2 text-white hover:text-gray-200 transition-colors duration-300">
        <!-- SVG Instagram Logo -->
        <a href="https://www.instagram.com/tidaklama/" target="_blank" aria-label="Instagram">
            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.204-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07s-3.583-.012-4.85-.069c-3.25-1.0-4.771-1.664-4.919-4.919-.058-1.265-.07-1.644-.07-4.849s.012-3.583.07-4.85c.149-3.25 1.664-4.771 4.919-4.919 1.266-.058 1.644-.07 4.85-.07zm0-2.163c-3.259 0-3.667.014-4.947.072-4.359.201-6.78 2.622-6.981 6.981-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.201 4.359 2.622 6.78 6.981 6.981 1.28.058 1.689.072 4.948.072s3.668-.014 4.948-.072c4.354-.201 6.782-2.622 6.981-6.981.058-1.28.072-1.689.072-4.948s-.014-3.667-.072-4.947c-.196-4.354-2.62-6.78-6.981-6.981-1.28-.059-1.689-.073-4.948-.073z"/>
                <path d="M12 7c-2.761 0-5 2.239-5 5s2.239 5 5 5 5-2.239 5-5-2.239-5-5-5zm0 8c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3z"/>
                <path d="M16.804 5.342c-.792 0-1.436.643-1.436 1.435s.644 1.435 1.436 1.435 1.435-.643 1.435-1.435-.643-1.435-1.435-1.435z"/>
            </svg>
        </a>
        <a href="https://www.instagram.com/tidaklama/" target="_blank" class="text-white hover:text-gray-200 transition-colors duration-300">@tidaklama</a>
    </div>

    <script>
        // Mendapatkan elemen DOM yang diperlukan
        const imageUpload = document.getElementById('imageUpload');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const downloadLink = document.getElementById('downloadLink');
        const reverseColorsCheckbox = document.getElementById('reverseColors');
        const imageArea = document.getElementById('imageArea');
        const contrastSlider = document.getElementById('contrastSlider');
        const contrastValueSpan = document.getElementById('contrastValue');
        const mainContent = document.getElementById('main-content');

        // Definisi warna Brave Pink dan Hero Green
        const bravePink = [247, 132, 197]; // #f784c5
        const heroGreen = [27, 96, 47];    // #1b602f

        // Variabel untuk menyimpan gambar asli
        let originalImage = null;

        // Event listener saat file diunggah
        imageUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.onload = () => {
                        // Simpan gambar asli
                        originalImage = img; 
                        processImage();
                    };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        // Event listener saat checkbox dibalik
        reverseColorsCheckbox.addEventListener('change', () => {
            // Memproses ulang gambar jika sudah ada yang diunggah
            if (originalImage) {
                processImage();
            }
        });

        // Event listener saat slider kontras digeser
        contrastSlider.addEventListener('input', () => {
            contrastValueSpan.textContent = contrastSlider.value;
            if (originalImage) {
                processImage();
            }
        });

        // Event listener saat tombol unduh diklik
        downloadLink.addEventListener('click', (e) => {
            // Mencegah tindakan default sementara
            e.preventDefault();

            // Memulai pengunduhan setelah tampilan diubah
            setTimeout(() => {
                const url = downloadLink.href;
                const a = document.createElement('a');
                a.href = url;
                a.download = 'duotone-image.png';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }, 500);

            // Mengubah tampilan halaman
            showFinalScreen();
        });

        // Fungsi utama untuk memproses gambar
        function processImage() {
            if (!originalImage) return;

            // Menampilkan area gambar
            imageArea.classList.remove('hidden');
            
            // Mengatur ukuran canvas sesuai dengan gambar
            canvas.width = originalImage.width;
            canvas.height = originalImage.height;
            
            // Menggambar gambar asli ke canvas
            ctx.drawImage(originalImage, 0, 0, canvas.width, canvas.height);
            
            // Mendapatkan data piksel dari canvas
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;
            
            let colorHighlight;
            let colorShadow;

            // Menentukan warna highlight dan shadow berdasarkan checkbox
            if (reverseColorsCheckbox.checked) {
                colorHighlight = heroGreen;
                colorShadow = bravePink;
            } else {
                colorHighlight = bravePink;
                colorShadow = heroGreen;
            }

            // Mendapatkan nilai kontras dari slider (faktor normalisasi)
            const contrastFactor = 1 + (parseInt(contrastSlider.value, 10) / 100);
            
            // Loop melalui setiap piksel untuk menerapkan efek duotone
            for (let i = 0; i < data.length; i += 4) {
                // Menghitung nilai grayscale (rata-rata R, G, B)
                const gray = (data[i] + data[i + 1] + data[i + 2]) / 3;
                
                // Menerapkan penyesuaian kontras pada nilai grayscale
                let contrastedGray = (gray - 128) * contrastFactor + 128;
                
                // Memastikan nilai tetap dalam rentang 0-255
                contrastedGray = Math.min(255, Math.max(0, contrastedGray));
                
                // Menghitung proporsi duotone berdasarkan nilai grayscale yang sudah dikontras
                const ratio = contrastedGray / 255;
                
                // Menginterpolasi warna baru untuk setiap piksel
                data[i] = colorHighlight[0] * ratio + colorShadow[0] * (1 - ratio);     // R
                data[i + 1] = colorHighlight[1] * ratio + colorShadow[1] * (1 - ratio); // G
                data[i + 2] = colorHighlight[2] * ratio + colorShadow[2] * (1 - ratio); // B
            }
            
            // Mengembalikan data piksel yang sudah diubah ke canvas
            ctx.putImageData(imageData, 0, 0);
            
            // Mengubah canvas menjadi URL gambar dan mengatur tautan unduh
            downloadLink.href = canvas.toDataURL('image/png');
        }

        function showFinalScreen() {
            // Mengubah warna latar belakang body
            document.body.classList.remove('bg-[#1b602f]');
            document.body.classList.add('bg-[#f784c5]');

            // Mengganti konten utama
            mainContent.classList.add('opacity-0');
            
            setTimeout(() => {
                mainContent.classList.remove('opacity-0');
                mainContent.classList.remove('bg-[#f784c5]');
                mainContent.classList.add('bg-[#1b602f]');
                mainContent.classList.add('p-8');
                mainContent.classList.add('md:p-12');

                mainContent.innerHTML = `
                    <h1 class="text-4xl font-bold text-white mb-6">Salam Perjuangan</h1>
                    <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-8">
                        <div class="bg-gray-800 rounded-lg shadow-xl overflow-hidden max-w-sm">
                            <img src="[URL_FOTO_1]" alt="Gambar 1" class="w-full h-auto">
                        </div>
                        <div class="bg-gray-800 rounded-lg shadow-xl overflow-hidden max-w-sm">
                            <img src="[URL_FOTO_2]" alt="Gambar 2" class="w-full h-auto">
                        </div>
                    </div>
                    <button onclick="location.reload()" class="inline-block mt-8 bg-[#f784c5] hover:bg-[#f56da6] text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-300 shadow-md">
                        Kembali
                    </button>
                `;
            }, 500);
        }
    </script>
</body>
</html>
